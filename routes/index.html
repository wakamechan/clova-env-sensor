<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8" />
<title>Chart</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.2/Chart.js"></script>
</head>
<body>
<h1>Chart</h1>
<div class="chart-container" style="position: relative; height:40vh; width:80vw">
  <canvas id="myChart"></canvas>
</div>
<ul id="messages"></ul>
<script src="/socket.io/socket.io.js"></script>
<script>
  var ctx = document.getElementById("myChart");
  var myChart = new Chart(ctx, {
      type: 'line',
      data: {
          labels: [1,2,3,4,5,6,7,8,9,10],
          datasets: [{
              label: "æ¸©åº¦",
              data: Array(10).fill(0),
              borderColor: [
                  'rgba(255, 159, 64, 1)'
              ],
              borderWidth: 2
          }]
      },
      options: {
          scales: {
              yAxes: [{
                  ticks: {
                      beginAtZero:true
                  }
              }]
          }
      }
  });
  var socket = io();
  
  socket.on('data', function (data) {
    var li = document.createElement('li');
    li.textContent = data;
    messages.appendChild(li);
    var d = JSON.parse(data);
    myChart.data.datasets.forEach((dataset) => {
        dataset.data.shift();
        dataset.data.push(Number(d.tm));
    });
    myChart.update();
  });

</script>
</body>
</html>

